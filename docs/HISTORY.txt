Changelog
=========

1.13.9 (2021-11-09)
-------------------

- Do not touch search term in default search (plone 5). [mathias.leimgruber]


1.13.8 (2021-06-08)
-------------------

- Fix render issues if we get a random query string. [mathias.leimgruber]


1.13.7 (2021-02-26)
-------------------

- Fix location hash with dot removes hash character [Nachtalb]


1.13.6 (2020-11-17)
-------------------

- Only use ajax pagination on search view. [mathias.leimgruber]


1.13.5 (2020-11-11)
-------------------

- Fix possible double slash if base url exists [mathias.leimgruber]


1.13.4 (2020-06-11)
-------------------

- Support plone 5 paginator new html structure on search result page. [mathias.leimgruber]


1.13.3 (2020-01-21)
-------------------

- Fix broken upgrade step introduced in 1.13.2. [mathias.leimgruber]


1.13.2 (2019-12-17)
-------------------

- Add max width for search result overlay on desktop computers. [busykoala]
- Fix livesearch on contentish [Nachtalb]
- Provide precompiled bundle [Nachtalb]


1.13.1 (2019-10-21)
-------------------

- Fix classifier - since it has to be in https://pypi.org/classifiers/. [mathias.leimgruber]


1.13.0 (2019-10-21)
-------------------

- Add Plone 5.1.x support [mathias.leimgruber]
- Drop AT support [mathias.leimgruber]
- Drop Wordcloud portlet (nowhere in use) [mathias.leimgruber]


1.12.1 (2019-10-17)
-------------------

- Remove searchterm highlighter word filter [Nachtalb]
- Fix rst syntax of readme [Nachtalb]


1.12.0 (2019-04-23)
-------------------

- Use binary adder from collective.solr. They work since version 5.0.3 [mathias.leimgruber]


1.11.0 (2019-04-11)
-------------------

- Accessibility: Don't use "cite" for breadcrumbs in results, use a list [mathias.leimgruber]

- Accessibility: Add heading for searchresult and hint for link path. [mathias.leimgruber]

- Fix use of highlightSearchTerms on livesearch if searching for multiple terms.
  jquery.highlightsearchterms needs a list of searchterms to work properly.
  [elioschmutz]

- Fix bad return value for facet infos.
  [elioschmutz]

- Fix disallowed html tag id name.
  [elioschmutz]

- Trigger an event after updating the search-results.
  [elioschmutz]

- Fix broken html-markup in available-facets.pt.
  [elioschmutz]


1.10.0 (2017-11-28)
-------------------

- Refactor `ftw.solr.browser.livesearch.FtwSolrLiveSearchReplyView` for easier
  subclassing. [mbaechtold]


1.9.5 (2017-11-03)
------------------

- Make snippet text upgrade from 1.9.4 more robust. [jone]

1.9.4 (2017-11-03)
------------------

- Fix escaping issue when highlighting plaintext. [jone]

- Always quote values of a list containing an operator.
  [mathias.leimgruber]

- Use searchform action as endpoint in search.js.
  [mathias.leimgruber]


1.9.3 (2017-08-28)
------------------

- Fix position of facet closing icon.
  [mbaechtold]


1.9.2 (2017-08-08)
------------------

- Also prevent a invalid urls generated by the livesearch.py
  [mathias.leimgruber]


1.9.1 (2017-08-08)
------------------

- Prevent invalid url if the object has a get parameter in his path.
  [lknoepfel]

- Remove search viewlet submit from tabindex.
  [lknoepfel]


1.9.0 (2017-06-28)
------------------

- Implement first suggestion on livesearch view, if suggestions are enabled.
  [mathias.leimgruber]


1.8.6 (2017-06-06)
------------------

- Hide and order the viewlets for all skins and not only for the "Sunburst Theme"-skin
  [elioschmutz]

- Prevent invalid url if the object has a get parameter in his path.
  [lknoepfel]


1.8.5 (2017-04-19)
------------------

- Lower searchwords in ISearchwords indexer, since the value is always lowered in ftw.solr.
  This applies only for DX content.
  [mathias.leimgruber]

- Fix font for livesearch results.
  [Kevin Bieri]


1.8.4 (2016-12-16)
------------------

- Make getting the facets more robust which caused projects having customizations
  of selected facets to crash when displaying the search results.
  [mbaechtold]


1.8.3 (2016-12-15)
------------------

- Remove hidden input from tabindex.
  [mathias.leimgruber]

- Only append "Search in current folder" option to livesearch if not on plone root.
  [mathias.leimgruber]


1.8.2 (2016-11-24)
------------------

- Scan for external links after every search page refresh.
  [mathias.leimgruber]

- Do not use TALES string expressions for facet links, since it automatically transforms
  chars into html entities.
  The facet links were like "&amp;amp;amp;amp;" every time you add/remove a facet.
  Since we have three facts by default this happened tree times on every click.
  [mathias.leimgruber]


1.8.1 (2016-11-04)
------------------

- Fix suggestion with umlauts by decode it to unicode.
  [mathias.leimgruber]

- Avoid AttributeError "solr_response" on solr errors. [jone]


1.8.0 (2016-10-31)
------------------

- Unquote the quoted description in autocomplete search result.
  [mathias.leimgruber]

- Explicitly remove invalid characters for solr search before passing the SearchableText to the catalog.
  Basically this means all Lucene query syntax special characters are stripped.
  Check https://lucene.apache.org/core/2_9_4/queryparsersyntax.html
  [mathias.leimgruber]


1.7.1 (2016-10-13)
------------------

- Allow hyphens, commas and single quotes in simple terms and simple searches.
  Fixes issue where a comma/hyphen/single quote in a search term causes
  search_pattern template to be circumvented.
  [mathias.leimgruber]


1.7.0 (2016-07-22)
------------------

- Implement link to remove the path from the querystring on the result page.
  [mathias.leimgruber]


1.6.3 (2016-07-18)
------------------

- Abort livesearch init if no searchfield is available to make the script failsafe.
  [elioschmutz]


1.6.2 (2016-07-15)
------------------

- Prevent the result text from read out through screenreaders
  [Kevin Bieri]

- Set searchwords as a non-required field.
  [elioschmutz]


1.6.1 (2016-07-11)
------------------

- Style selected facettes.
  [mathias.leimgruber]

- Add icon to facets dropdown menu.
  [Kevin Bieri]

- Fix faulty upgrade step which incorrectly added the Solr index queue processor
  utility in 1.5.0.
  [mbaechtold]


1.6.0 (2016-06-07)
------------------

- Add IShowInSearch and ISearchwords behaviors. [jone]

- Fix html structure of search in current folder. input in a tag is not allowed.
  [mathias.leimgruber]


1.5.3 (2016-05-23)
------------------

- BugFix: Search for "current folder". Label was some kind of unclickable. :-( omg sry.
  [mathias.leimgruber]


1.5.2 (2016-05-20)
------------------

- BugFix: Search for "current folder". Checkbox was unclickable.
  [mathias.leimgruber]

- Disable special links on facets dropdown.
  [Kevin Bieri]


1.5.1 (2016-04-29)
------------------

- Fix faulty upgrade step which removed the Solr connection manager utility
  in 1.5.0.
  [mbaechtold]

- Respect the facets configured in the Solr control panel.
  [mbaechtold]


1.5.0 (2016-03-31)
------------------

- Fix css selector of selected facest.
  [mathias.leimgruber]

- Implement accessible remove facet link.
  [mathias.leimgruber]

- Implement accessibility support for solr facets.
  [Kevin Bieri]

- Make `only in current folder section` selectable in the dropdown menu.
  [Kevin Bieri]

- Adjust stylings for the new ftw.theming.
  [elioschmutz]

- Do not reset the page title on facette search.
  [mathias.leimgruber]

- Use a different request handler for the livesearch.
  [buchi]

- Implement a new livesearch based on jquery autocomplete widget.
  [mathias.leimgruber]

- Moved atomic update feature to collective.solr.
  [mathias.leimgruber]


1.4.4 (2015-12-23)
------------------

- Add English, French and Italian translation of the time range facets (and
  a selection of other message ids).
  [mbaechtold]


1.4.3 (2015-08-11)
------------------

- Fix display of results when the search returns Brains and not Solr flares.
  This fixes searches which don't include searchableText.
  [tschanzt]


1.4.2 (2015-04-24)
------------------

- Fix quoting of searchterm url parameter in search result links.
  [buchi]


1.4.1 (2015-03-25)
------------------

- Allow dots in simple terms / simple searches.
  Fixes issue where a dot in a search term causes the search_pattern template to
  be circumvented, and therefore messing up the relevancy ranking.
  [lgraf]


1.4.0 (2015-02-26)
------------------

- Add support for search results from external sites. Solr flares having a
  getRemoteUrl attribute that starts with 'http' are handled as external
  results. External sites can be indexed with ftw.crawler.
  [buchi]

- BugFix in "recursive_index_security" method. Do not try to reindex the
  security on not catalog aware objects.
  [mathias.leimgruber]

- Some work on docs (fix Pythonism, add some info, improve markup). [jean]


1.3.1 (2014-06-12)
------------------

- Fix error in suggestions when there is no solr response.
  [buchi]

- Make sure that string attributes of a PloneFlare are always utf-8 encoded
  byte strings to be consistent with catalog brains.
  [buchi]


1.3 (2013-12-19)
----------------

- Updated jquery.history.js to latest version (1.8.0b2) which fixes issues
  with URI encoding in IE9.
  [buchi]

- Removed link to advanced search in livesearch when no results are found.
  [buchi]

- "show all"-link includes the path attribute.
  [elioschmutz]

- Added support for forward as well as reverse wildcard search.
  This is done by providing two additional dynamic variables in the search pattern,
  value_lwc and value_twc that have leading respectively trailing wildcards appended
  to each of the search terms.
  [lgraf]

- Fix querystring of suggestions with list parameters.
  [buchi]


1.2.2 (2013-09-24)
------------------

- Added class around link to advanced search.
  [Julian Infanger]


1.2.1 (2013-09-10)
------------------

- Fixed monkey patch of mangleQuery.
  [buchi]


1.2 (2013-09-10)
----------------

- Improve reindexing object security performance.
  We now walk down the children and stop walking down if the security indexes
  of an object have not changed.
  [jone]

- Added support for atomic updates.
  This means whenever possible, only the necessary / specified attributes get updated
  in Solr, and more importantly, re-indexed by Plone's indexers.
  IMPORTANT: This requires the Solr instance to have an <updateLog/> configured in
  solrconfig.xml and the schema needs to contain a _version_ field.
  See http://wiki.apache.org/solr/Atomic_Updates for details.
  [lgraf]

- Make sure values in search patterns are all lowercase.
  [buchi]


1.1.2 (2013-07-18)
------------------

- Sort facet fields in the order specified in the Solr control panel.
  [buchi]

- Fixed handling of path filter which was always removed when respect_navroot
  is set to False.
  [buchi]

- Handle invalid facet parameters.
  [buchi]

- Monkey patch reindexObjectSecurity for both CatalogAware and CatalogMultiplex
  so the relevant security indexes in solr also get updated.
  [lgraf]

- Only add the default search argument to the query if it's not None and if
  Solr has a default search field defined in it's schema (which is deprecated
  in Solr). This mainly prevents logging of 'dropping unknown search attribute'
  warnings.
  [buchi]

- Escape forward slashes in all query values, not only in paths.
  [buchi]

- Always insert the default 'select' search handler into the query parameters if
  no 'qt' parameter is provided. We need this because we have to disable the
  /select search handler in the Solr configuration to be able to select other search
  handlers by parameter.
  [buchi]


1.1.1 (2013-06-01)
------------------

- Also use livesearch request handler in livesearch when grouping is disabled.
  [buchi]

- Fixed "show more" link in live search to point to @@search view.
  [buchi]


1.1 (2013-05-31)
----------------

- Reorganized monkey patches.
  Everything patch-related now lives in the patches subpackage.
  [lgraf]

- Make sure @@search view doesn't fail when called without parameters.
  [lgraf]

- Only display selected facets list if there actually are selected facets.
  [lgraf]

- Added spellchecking feature (aka "Did you mean ...").
  [buchi]

- Made respecting the navroot for searches configurable.
  Only if `ISearchSettings.respect_navroot` is set searches will be constrained
  to the navigation root (defaults to False).
  [lgraf]

- Added autocomplete support based on Solr's suggester component.
  [buchi]


1.0.2 (2013-05-28)
------------------

- Fixed querytarget of livesearch for Plone 4.2 and later.
  Use our @@livesearch_reply view instead of livesearch_reply.
  [buchi]

- Include description in snippetText.
  [buchi]

- If there's a SearchableText indexer, use it for snippetText generation.
  [buchi]

- Make length of breadcrumbs shown in search results configurable.
  [buchi]

- Added option to generate breadcrumbs from path rather than calling
  breadcrumbs_view for each item.
  [buchi]

- Added support for dexterity content types in snippetText indexer.
  [buchi]


1.0.1 (2013-05-21)
------------------

- Monkey patching c.solr.search.Search.buildQuery in order to escape slahes in paths.
  [lgraf]

- Overwrite search extender: Add write permissions, fixed translations and
  allowed content types in textfield.
  [Julian Infanger]

- Added option to scale Word Cloud by a constant factor.
  [lgraf]

- Added basic portlet to display Word Cloud.
  [lgraf]

- Added basic Word Cloud browser view.
  [lgraf]


1.0a1 (2012-08-22)
------------------

- Initial release
